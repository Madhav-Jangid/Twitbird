<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madhav's Clone</title>

</head>
<button id="post">Send</button>

<body>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getDatabase, ref, get, update } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBm3UC_TCpO0Y_yUFnG3nQNjdZeir3wqX4",
            authDomain: "clone-of-x.firebaseapp.com",
            databaseURL: "https://clone-of-x-default-rtdb.firebaseio.com",
            projectId: "clone-of-x",
            storageBucket: "clone-of-x.appspot.com",
            messagingSenderId: "309786442519",
            appId: "1:309786442519:web:bcd80e8ac6be220b64d552"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase();
        const auth = getAuth(app);




        // Example usage:
        const CurrentUserId = "5wF26YhQ9cPmuKr7W6RGQ8o8XgS2";
        const receiverUid = "5wF26YhQ9cPmuKr7W6RGQ8o8XgS2";
        const message = "Kida frrr";


        document.getElementById('post').addEventListener('click', function () {
            console.log('clicked')
            ShowMessegedUsers();
        })


        function ShowMessegedUsers() {
            if (CurrentUserId) {
                const userRef = ref(db, 'UserAuthList/' + CurrentUserId);
                get(userRef)
                    .then((snapshot) => {
                        if (snapshot.exists()) {
                            let userData = snapshot.val();
                            if(userData.Messages){
                                for(const user in userData.Messages){
                                    let userRef = ref(db, 'UserAuthList/' + user);
                                    get(userRef)
                                    .then((snapshot) => {
                                        if(snapshot.exists()){
                                            let userData = snapshot.val();
                                            console.log(userData.Name,'@'+userData.Username)
                                        }
                                    })
                                }
                            }else{
                                console.log('No Messeges Yet')
                            }
                        } else {
                            console.error('User data does not exist');
                        }
                    })
                    .catch((error) => {
                        console.error('Error fetching user data:', error);
                    });
            }
            else {
                alert('CurrentUserId is undefined');
            }
        }
    </script>
</body>

</html>